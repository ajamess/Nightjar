(node:48388) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
  console.error
    Warning: An update to RequestDetail inside a test was not wrapped in act(...).
    
    When testing, code that causes React state updates should be wrapped into act(...):
    
    act(() => {
      /* fire events that update state */
    });
    /* assert on the output */
    
    This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
        at request (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\frontend\src\components\inventory\common\RequestDetail.jsx:42:3)

      75 |         const km = getWorkspaceKeyMaterial(currentWorkspace, workspaceId);
      76 |         const addr = await getAddress(km, inventorySystemId, request.id);
    > 77 |         if (!cancelled && addr) setFullAddress(addr);
         |                                 ^
      78 |       } catch {
      79 |         // Address may not exist locally for this admin
      80 |       }

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setFullAddress (frontend/src/components/inventory/common/RequestDetail.jsx:77:33)

  console.warn
    [ApprovalQueue] Address reveal not created ΓÇö address not found in local store or pending addresses for request req-edge

      129 |           ctx.yAddressReveals?.set(requestId, { ...reveal, inventorySystemId: ctx.inventorySystemId });
      130 |         } else if (!addr) {
    > 131 |           console.warn('[ApprovalQueue] Address reveal not created ΓÇö address not found in local store or pending addresses for request', requestId?.slice(0, 8));
          |                   ^
      132 |         } else if (!ctx.userIdentity?.curveSecretKey) {
      133 |           console.warn('[ApprovalQueue] Address reveal not created ΓÇö admin encryption key not available');
      134 |         }

      at warn (frontend/src/components/inventory/admin/ApprovalQueue.jsx:131:19)
      at handleApprove (frontend/src/components/inventory/admin/ApprovalQueue.jsx:427:73)
      at HTMLUnknownElement.callCallback (node_modules/react-dom/cjs/react-dom.development.js:4164:14)
      at HTMLUnknownElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at invokeGuardedCallbackAndCatchFirstError (node_modules/react-dom/cjs/react-dom.development.js:4291:25)
      at executeDispatch (node_modules/react-dom/cjs/react-dom.development.js:9041:3)
      at processDispatchQueueItemsInOrder (node_modules/react-dom/cjs/react-dom.development.js:9073:7)
      at processDispatchQueue (node_modules/react-dom/cjs/react-dom.development.js:9086:5)
      at dispatchEventsForPlugins (node_modules/react-dom/cjs/react-dom.development.js:9097:3)
      at node_modules/react-dom/cjs/react-dom.development.js:9288:12
      at batchedUpdates$1 (node_modules/react-dom/cjs/react-dom.development.js:26179:12)
      at batchedUpdates (node_modules/react-dom/cjs/react-dom.development.js:3991:12)
      at dispatchEventForPluginEventSystem (node_modules/react-dom/cjs/react-dom.development.js:9287:3)
      at dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay (node_modules/react-dom/cjs/react-dom.development.js:6465:5)
      at dispatchEvent (node_modules/react-dom/cjs/react-dom.development.js:6457:5)
      at dispatchDiscreteEvent (node_modules/react-dom/cjs/react-dom.development.js:6430:5)
      at HTMLDivElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLButtonElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLButtonElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLButtonElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at node_modules/@testing-library/dom/dist/events.js:19:20
      at node_modules/@testing-library/react/dist/pure.js:108:16
      at node_modules/@testing-library/react/dist/act-compat.js:48:24
      at act (node_modules/react/cjs/react.development.js:2512:16)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at Object.eventWrapper (node_modules/@testing-library/react/dist/pure.js:107:28)
      at fireEvent (node_modules/@testing-library/dom/dist/events.js:12:35)
      at Function.fireEvent.<computed> [as click] (node_modules/@testing-library/dom/dist/events.js:110:36)
      at Function.fireEvent.<computed> [as click] (node_modules/@testing-library/react/dist/fire-event.js:15:52)
      at Object.click (tests/producer-shipping-workflow.test.jsx:1504:15)

  console.warn
    [ApprovalQueue] Could not create address reveal: Error: Decryption failed
        at Object.<anonymous> (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\tests\producer-shipping-workflow.test.jsx:1526:53)
        at Promise.then.completed (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-runner\build\runTest.js:444:34)

      134 |         }
      135 |       } catch (err) {
    > 136 |         console.warn('[ApprovalQueue] Could not create address reveal:', err);
          |                 ^
      137 |       }
      138 |     }
      139 |

      at warn (frontend/src/components/inventory/admin/ApprovalQueue.jsx:136:17)

  console.error
    Warning: An update to ApprovalQueue inside a test was not wrapped in act(...).
    
    When testing, code that causes React state updates should be wrapped into act(...):
    
    act(() => {
      /* fire events that update state */
    });
    /* assert on the output */
    
    This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
        at ApprovalQueue (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\frontend\src\components\inventory\admin\ApprovalQueue.jsx:20:43)

      161 |     }
      162 |
    > 163 |     setSelected(prev => { const n = new Set(prev); n.delete(requestId); return n; });
          |     ^
      164 |   }, [findAndUpdateRequest, adminNotes, logAudit, ctx.userIdentity, ctx.yInventoryNotifications, ctx.inventorySystemId, ctx.currentWorkspace, ctx.workspaceId, ctx.yPendingAddresses, ctx.yAddressReveals]);
      165 |
      166 |   const handleReject = useCallback((requestId) => {

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setSelected (frontend/src/components/inventory/admin/ApprovalQueue.jsx:163:5)

  console.error
    [AddressReveal] Decryption failed: Error: Wrong key
        at Object.<anonymous> (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\tests\producer-shipping-workflow.test.jsx:1569:52)
        at Promise.then.completed (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Adam Steenwyk\Documents\Code\Nightjar\node_modules\jest-runner\build\runTest.js:444:34)

      51 |         if (!cancelled) setAddress(addr);
      52 |       } catch (err) {
    > 53 |         console.error('[AddressReveal] Decryption failed:', err);
         |                 ^
      54 |         if (!cancelled) setDecryptError('Could not decrypt the shipping address. Make sure you are the assigned producer.');
      55 |       }
      56 |     })();

      at error (frontend/src/components/inventory/producer/AddressReveal.jsx:53:17)

FAIL tests/producer-shipping-workflow.test.jsx
  ApprovalQueue ΓÇö getAddress fix (Bug #1)
    ΓêÜ calls getWorkspaceKeyMaterial with currentWorkspace and workspaceId (34 ms)
    ΓêÜ calls getAddress with (keyMaterial, inventorySystemId, requestId) in correct order (8 ms)
    ΓêÜ creates address reveal with inventorySystemId attached (59 ms)
  ApprovalQueue ΓÇö pending address decryption (Bug #2)
    ΓêÜ falls back to yPendingAddresses when local address not found (57 ms)
    ΓêÜ stores decrypted pending address locally and deletes pending entry (59 ms)
    ΓêÜ creates address reveal from decrypted pending address (56 ms)
    ΓêÜ does not attempt decryptPendingAddress when local address exists (56 ms)
  ApprovalQueue ΓÇö inventorySystemId on reveals (Bug #3)
    ΓêÜ attaches inventorySystemId so useInventorySync filter passes (55 ms)
  RequestDetail ΓÇö status visibility (Bug #4)
    ΓêÜ shows shipping UI for approved status (17 ms)
    ΓêÜ shows shipping UI for in_progress status (4 ms)
    ΓêÜ does NOT show shipping UI for claimed status (6 ms)
    ΓêÜ does NOT show shipping UI for shipped status (3 ms)
  RequestDetail ΓÇö inline AddressReveal
    ΓêÜ renders AddressReveal inline when address reveal exists for producer (15 ms)
    ΓêÜ shows shipping providers when AddressReveal is rendered inline (10 ms)
    ΓêÜ shows no-reveal fallback when address reveal does not exist (5 ms)
    ΓêÜ does NOT show AddressReveal for admin role (shows full address from local store instead) (5 ms)
  RequestDetail ΓÇö getAddress fix
    ΓêÜ calls getAddress with correct arguments when loading admin full address (6 ms)
    ΓêÜ displays full address for admin when address is loaded (9 ms)
    ΓêÜ gracefully handles getWorkspaceKeyMaterial failure (3 ms)
  ProducerMyRequests ΓÇö onMarkShipped handler (Bug #5)
    ΓêÜ renders View Address button when address reveal exists (5 ms)
    ΓêÜ shows AddressReveal inline in RequestDetail when clicking a card with a reveal (17 ms)
    ΓêÜ shows Mark In Progress button for approved requests (3 ms)
    ΓêÜ shows View Address for in_progress requests with reveal (3 ms)
  AddressReveal ΓÇö shipping providers and confirm flow
    ΓêÜ shows shipping provider buttons when providers are enabled (6 ms)
    ΓêÜ shows copy address button after decryption (6 ms)
    ΓêÜ mark shipped button is disabled until confirmation checkbox is checked (25 ms)
    ΓêÜ shows phone number when address includes phone (6 ms)
    ΓêÜ shows tracking number input (10 ms)
    ΓêÜ shows shipping notes textarea (4 ms)
    ├ù shows privacy note about address deletion (1017 ms)
    ΓêÜ shows request info section with item details (7 ms)
  E2E Scenario: Owner-submitted address ΓåÆ approve ΓåÆ producer ships
    ΓêÜ admin approves claimed request ΓåÆ address reveal created from local store (54 ms)
  E2E Scenario: Non-owner-submitted address ΓåÆ approve ΓåÆ producer ships
    ΓêÜ admin approves ΓåÆ decrypts pending address ΓåÆ creates reveal (57 ms)
  E2E Scenario: Producer views address and ships
    ΓêÜ producer sees decrypted address and shipping providers in RequestDetail (16 ms)
  E2E Scenario: Approval without assignedTo
    ΓêÜ does not attempt address reveal when no producer assigned (104 ms)
  E2E Scenario: Bulk approve with address reveals
    ΓêÜ bulk approve creates reveals for all selected requests (11 ms)
  RequestDetail ΓÇö Mark In Progress button
    ├ù shows Mark In Progress button for approved status when onMarkInProgress is provided (4 ms)
    ΓêÜ does NOT show Mark In Progress button for in_progress status (2 ms)
    ΓêÜ does NOT show Mark In Progress button when onMarkInProgress is not provided (7 ms)
    ├ù calls onMarkInProgress with the request when clicked (4 ms)
    ΓêÜ does NOT show Mark In Progress for admin role (24 ms)
  ProducerMyRequests ΓÇö Mark In Progress via RequestDetail
    ├ù passes onMarkInProgress to RequestDetail and closes panel on click (1009 ms)
  InventoryContext ΓÇö currentWorkspace availability
    ΓêÜ context value includes currentWorkspace
    ΓêÜ context value includes workspaceId (1 ms)
  useInventorySync ΓÇö addressReveals filter
    ΓêÜ filters reveals by inventorySystemId
    ΓêÜ excludes reveals without inventorySystemId (the old bug) (1 ms)
  Edge cases and error handling
    ΓêÜ ApprovalQueue handles missing currentWorkspace gracefully (118 ms)
    ΓêÜ ApprovalQueue handles decryptPendingAddress failure gracefully (104 ms)
    ΓêÜ RequestDetail handles missing address reveal gracefully for producer (4 ms)
    ΓêÜ AddressReveal handles decryption failure with error message (7 ms)
    ΓêÜ ProducerMyRequests handles empty requests (2 ms)
System.Management.Automation.RemoteException
  ΓùÅ AddressReveal ΓÇö shipping providers and confirm flow ΓÇ║ shows privacy note about address deletion
System.Management.Automation.RemoteException
    Unable to find an element with the text: /encrypted address will be permanently deleted/. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.
System.Management.Automation.RemoteException
    Ignored nodes: comments, script, style
    <body
      style=""
    >
      <div>
        <div
          class="address-reveal"
        >
          <div
            class="ar-header"
          >
            <h3>
              Shipping Address
            </h3>
          </div>
          <div
            class="ar-request-info"
          >
            <div
              class="ar-request-info__row"
            >
              <span
                class="ar-request-info__label"
              >
                Item:
              </span>
              <span>
                Widget
              </span>
            </div>
            <div
              class="ar-request-info__row"
            >
              <span
                class="ar-request-info__label"
              >
                Qty:
              </span>
              <span>
                50
                 
                units
              </span>
            </div>
            <div
              class="ar-request-info__row"
            >
              <span
                class="ar-request-info__label"
              >
                Location:
              </span>
              <span>
                Denver
                , 
                CO
              </span>
            </div>
            <div
              class="ar-request-info__row"
            >
              <span
                class="ar-request-info__label"
              >
                Requested:
              </span>
              <span>
                2/17/2026
              </span>
            </div>
          </div>
          <div
            class="ar-address-block"
          >
            <span
              class="ar-decrypt-label"
            >
              ≡ƒöÆ Decrypted with your private key
            </span>
            <p
              class="ar-name"
            >
              Jane Doe
            </p>
            <p>
              456 Oak Ave
            </p>
            <p>
              Portland
              , 
              OR
               
              97201
            </p>
            <p>
              US
            </p>
            <p
              class="ar-phone"
            >
              Phone: 
              503-555-1234
            </p>
          </div>
          <button
            class="ar-copy-btn"
          >
            ≡ƒôï Copy Address
          </button>
          <div
            class="ar-provider-group"
          >
            <span
              class="ar-provider-label"
            >
              Ship with
            </span>
            <div
              class="ar-provider-buttons"
            >
              <button
                class="ar-provider-btn"
                title="Copy address & open PirateShip"
              >
                <span
                  class="ar-provider-icon"
                >
                  ≡ƒÅ┤ΓÇìΓÿá∩╕Å
                </span>
                <span
                  class="ar-provider-name"
                >
                  PirateShip
                </span>
              </button>
            </div>
            <span
              class="ar-provider-hint"
            >
              Address is copied to clipboard ΓÇö paste into the shipping site
            </span>
          </div>
          <div
            class="ar-ship-section"
          >
            <label
              class="ar-tracking-label"
            >
              Tracking Number (optional)
              <input
                class="ar-tracking-input"
                placeholder="e.g., 1Z999AA10123456784"
                type="text"
                value=""
              />
            </label>
            <label
              class="ar-tracking-label"
            >
              Notes (optional)
              <textarea
                class="ar-notes-input"
                placeholder="Any shipping notes..."
                rows="2"
              />
            </label>
            <label
              class="ar-confirm-label"
            >
              <input
                type="checkbox"
              />
              I've recorded the shipping info and am ready to mark this as shipped
            </label>
            <button
              class="ar-ship-btn"
              disabled=""
            >
              ≡ƒôª Mark Shipped
            </button>
            <button
              class="ar-unclaim-btn btn-sm btn-secondary"
            >
              Γå⌐∩╕Å Unclaim this request
            </button>
            <p
              class="ar-privacy-note"
            >
              The encrypted address is automatically deleted when the request is delivered or cancelled.
            </p>
          </div>
        </div>
      </div>
    </body>
System.Management.Automation.RemoteException
      1027 |     render(<AddressReveal requestId="req-ar1" reveal={reveal} identity={identity} />);
      1028 |
    > 1029 |     await waitFor(() => {
           |                  ^
      1030 |       expect(screen.getByText(/encrypted address will be permanently deleted/)).toBeInTheDocument();
      1031 |     });
      1032 |   });
System.Management.Automation.RemoteException
      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/producer-shipping-workflow.test.jsx:1029:18)
System.Management.Automation.RemoteException
  ΓùÅ RequestDetail ΓÇö Mark In Progress button ΓÇ║ shows Mark In Progress button for approved status when onMarkInProgress is provided
System.Management.Automation.RemoteException
    TestingLibraryElementError: Unable to find an element with the text: ≡ƒö¿ Mark In Progress. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.
System.Management.Automation.RemoteException
    Ignored nodes: comments, script, style
    <body
      style=""
    >
      <div>
        <div
          class="request-detail"
          data-testid="request-detail"
        >
          <div
            class="request-detail__header"
          >
            <h3>
              Request #
              mip1
            </h3>
            <button
              aria-label="Close"
              class="request-detail__close"
            >
              Γ£ò
            </button>
          </div>
          <div
            class="request-detail__status-banner request-detail__status-banner--approved"
          >
            <span
              class="status-badge status-badge--approved "
            >
              Approved
            </span>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              Request Info
            </div>
            <div
              class="request-detail__grid"
            >
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Item
                </span>
                <span
                  class="request-detail__value"
                >
                  Test Item
                </span>
              </div>
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Quantity
                </span>
                <span
                  class="request-detail__value"
                >
                  10
                   
                  units
                </span>
              </div>
            </div>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              Location
            </div>
            <div
              class="request-detail__grid"
            >
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  City / State
                </span>
                <span
                  class="request-detail__value"
                >
                  Denver
                  , 
                  CO
                </span>
              </div>
            </div>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              People
            </div>
            <div
              class="request-detail__grid"
            >
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Requested by
                </span>
                <span
                  class="request-detail__value"
                >
                  user-abcΓÇª
                  <button
                    aria-label="Start chat with user-abcΓÇª"
                    class="chat-btn-inline"
                    data-testid="chat-button"
                    title="Chat with user-abcΓÇª"
                    type="button"
                  >
                    ≡ƒÆ¼
                  </button>
                </span>
              </div>
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Assigned to
                </span>
                <span
                  class="request-detail__value"
                >
                  Bob Producer
                  <button
                    aria-label="Start chat with Bob Producer"
                    class="chat-btn-inline"
                    data-testid="chat-button"
                    title="Chat with Bob Producer"
                    type="button"
                  >
                    ≡ƒÆ¼
                  </button>
                </span>
              </div>
            </div>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              Shipping
            </div>
            <div
              class="request-detail__grid"
            />
          </div>
          <div
            class="request-detail__stage-section"
          >
            <div
              class="request-detail__early-timeline"
            >
              <div
                class="request-detail__early-step"
              >
                <span
                  class="request-detail__early-check"
                >
                  Γ£ô
                </span>
                <span
                  class="request-detail__early-label"
                >
                  Requested
                </span>
                <span
                  class="request-detail__early-date"
                >
                  Feb 17, 2026
                </span>
              </div>
            </div>
            <div
              aria-label="Fulfillment stage"
              class="request-detail__stage-bar"
              data-testid="stage-bar"
              role="group"
            >
              <button
                aria-current="step"
                class="stage-btn stage-btn--active stage-btn--approved"
                data-testid="stage-btn-approved"
                disabled=""
                title="Current stage: Approved"
              >
                <span
                  class="stage-btn__icon"
                >
                  Γ£ô
                </span>
                <span
                  class="stage-btn__label"
                >
                  Approved
                </span>
              </button>
              <button
                class="stage-btn stage-btn--future stage-btn--in_progress"
                data-testid="stage-btn-in_progress"
                title="Move to In Progress"
              >
                <span
                  class="stage-btn__icon"
                >
                  ≡ƒö¿
                </span>
                <span
                  class="stage-btn__label"
                >
                  In Progress
                </span>
              </button>
              <button
                class="stage-btn stage-btn--future stage-btn--shipped"
                data-testid="stage-btn-shipped"
                title="Move to Shipped"
              >
                <span
                  class="stage-btn__icon"
                >
                  ≡ƒôª
                </span>
                <span
                  class="stage-btn__label"
                >
                  Shipped
                </span>
              </button>
            </div>
          </div>
          <div
            class="request-detail__actions"
          >
            <div
              class="request-detail__ship-form"
            >
              <p
                class="request-detail__no-reveal"
              >
                ΓÅ│ Address reveal pending ΓÇö the reveal hasn't synced yet.
              </p>
              <label>
                Tracking # (optional)
                <input
                  placeholder="1Z999AA10123456784"
                  type="text"
                  value=""
                />
              </label>
              <button
                class="btn-primary"
              >
                ≡ƒôª Mark as Shipped
              </button>
            </div>
          </div>
        </div>
      </div>
    </body>
System.Management.Automation.RemoteException
      1270 |     );
      1271 |
    > 1272 |     expect(screen.getByText('≡ƒö¿ Mark In Progress')).toBeInTheDocument();
           |                   ^
      1273 |   });
      1274 |
      1275 |   it('does NOT show Mark In Progress button for in_progress status', () => {
System.Management.Automation.RemoteException
      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/producer-shipping-workflow.test.jsx:1272:19)
System.Management.Automation.RemoteException
  ΓùÅ RequestDetail ΓÇö Mark In Progress button ΓÇ║ calls onMarkInProgress with the request when clicked
System.Management.Automation.RemoteException
    TestingLibraryElementError: Unable to find an element with the text: ≡ƒö¿ Mark In Progress. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.
System.Management.Automation.RemoteException
    Ignored nodes: comments, script, style
    <body
      style=""
    >
      <div>
        <div
          class="request-detail"
          data-testid="request-detail"
        >
          <div
            class="request-detail__header"
          >
            <h3>
              Request #
              mip4
            </h3>
            <button
              aria-label="Close"
              class="request-detail__close"
            >
              Γ£ò
            </button>
          </div>
          <div
            class="request-detail__status-banner request-detail__status-banner--approved"
          >
            <span
              class="status-badge status-badge--approved "
            >
              Approved
            </span>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              Request Info
            </div>
            <div
              class="request-detail__grid"
            >
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Item
                </span>
                <span
                  class="request-detail__value"
                >
                  Test Item
                </span>
              </div>
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Quantity
                </span>
                <span
                  class="request-detail__value"
                >
                  10
                   
                  units
                </span>
              </div>
            </div>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              Location
            </div>
            <div
              class="request-detail__grid"
            >
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  City / State
                </span>
                <span
                  class="request-detail__value"
                >
                  Denver
                  , 
                  CO
                </span>
              </div>
            </div>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              People
            </div>
            <div
              class="request-detail__grid"
            >
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Requested by
                </span>
                <span
                  class="request-detail__value"
                >
                  user-abcΓÇª
                  <button
                    aria-label="Start chat with user-abcΓÇª"
                    class="chat-btn-inline"
                    data-testid="chat-button"
                    title="Chat with user-abcΓÇª"
                    type="button"
                  >
                    ≡ƒÆ¼
                  </button>
                </span>
              </div>
              <div
                class="request-detail__field"
              >
                <span
                  class="request-detail__label"
                >
                  Assigned to
                </span>
                <span
                  class="request-detail__value"
                >
                  Bob Producer
                  <button
                    aria-label="Start chat with Bob Producer"
                    class="chat-btn-inline"
                    data-testid="chat-button"
                    title="Chat with Bob Producer"
                    type="button"
                  >
                    ≡ƒÆ¼
                  </button>
                </span>
              </div>
            </div>
          </div>
          <div
            class="request-detail__section"
          >
            <div
              class="request-detail__section-title"
            >
              Shipping
            </div>
            <div
              class="request-detail__grid"
            />
          </div>
          <div
            class="request-detail__stage-section"
          >
            <div
              class="request-detail__early-timeline"
            >
              <div
                class="request-detail__early-step"
              >
                <span
                  class="request-detail__early-check"
                >
                  Γ£ô
                </span>
                <span
                  class="request-detail__early-label"
                >
                  Requested
                </span>
                <span
                  class="request-detail__early-date"
                >
                  Feb 17, 2026
                </span>
              </div>
            </div>
            <div
              aria-label="Fulfillment stage"
              class="request-detail__stage-bar"
              data-testid="stage-bar"
              role="group"
            >
              <button
                aria-current="step"
                class="stage-btn stage-btn--active stage-btn--approved"
                data-testid="stage-btn-approved"
                disabled=""
                title="Current stage: Approved"
              >
                <span
                  class="stage-btn__icon"
                >
                  Γ£ô
                </span>
                <span
                  class="stage-btn__label"
                >
                  Approved
                </span>
              </button>
              <button
                class="stage-btn stage-btn--future stage-btn--in_progress"
                data-testid="stage-btn-in_progress"
                title="Move to In Progress"
              >
                <span
                  class="stage-btn__icon"
                >
                  ≡ƒö¿
                </span>
                <span
                  class="stage-btn__label"
                >
                  In Progress
                </span>
              </button>
              <button
                class="stage-btn stage-btn--future stage-btn--shipped"
                data-testid="stage-btn-shipped"
                title="Move to Shipped"
              >
                <span
                  class="stage-btn__icon"
                >
                  ≡ƒôª
                </span>
                <span
                  class="stage-btn__label"
                >
                  Shipped
                </span>
              </button>
            </div>
          </div>
          <div
            class="request-detail__actions"
          >
            <div
              class="request-detail__ship-form"
            >
              <p
                class="request-detail__no-reveal"
              >
                ΓÅ│ Address reveal pending ΓÇö the reveal hasn't synced yet.
              </p>
              <label>
                Tracking # (optional)
                <input
                  placeholder="1Z999AA10123456784"
                  type="text"
                  value=""
                />
              </label>
              <button
                class="btn-primary"
              >
                ≡ƒôª Mark as Shipped
              </button>
            </div>
          </div>
        </div>
      </div>
    </body>
System.Management.Automation.RemoteException
      1339 |     );
      1340 |
    > 1341 |     fireEvent.click(screen.getByText('≡ƒö¿ Mark In Progress'));
           |                            ^
      1342 |     expect(onMarkInProgress).toHaveBeenCalledWith(req);
      1343 |   });
      1344 |
System.Management.Automation.RemoteException
      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/producer-shipping-workflow.test.jsx:1341:28)
System.Management.Automation.RemoteException
  ΓùÅ ProducerMyRequests ΓÇö Mark In Progress via RequestDetail ΓÇ║ passes onMarkInProgress to RequestDetail and closes panel on click
System.Management.Automation.RemoteException
    Unable to find an element with the text: ≡ƒö¿ Mark In Progress. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.
System.Management.Automation.RemoteException
    Ignored nodes: comments, script, style
    <div
      class="slide-panel__body"
    >
      <div
        class="request-detail"
        data-testid="request-detail"
      >
        <div
          class="request-detail__header"
        >
          <h3>
            Request #
            mipd1
          </h3>
          <button
            aria-label="Close"
            class="request-detail__close"
          >
            Γ£ò
          </button>
        </div>
        <div
          class="request-detail__status-banner request-detail__status-banner--approved"
        >
          <span
            class="status-badge status-badge--approved "
          >
            Approved
          </span>
        </div>
        <div
          class="request-detail__section"
        >
          <div
            class="request-detail__section-title"
          >
            Request Info
          </div>
          <div
            class="request-detail__grid"
          >
            <div
              class="request-detail__field"
            >
              <span
                class="request-detail__label"
              >
                Item
              </span>
              <span
                class="request-detail__value"
              >
                Widget
              </span>
            </div>
            <div
              class="request-detail__field"
            >
              <span
                class="request-detail__label"
              >
                Quantity
              </span>
              <span
                class="request-detail__value"
              >
                10
                 
                units
              </span>
            </div>
          </div>
        </div>
        <div
          class="request-detail__section"
        >
          <div
            class="request-detail__section-title"
          >
            Location
          </div>
          <div
            class="request-detail__grid"
          >
            <div
              class="request-detail__field"
            >
              <span
                class="request-detail__label"
              >
                City / State
              </span>
              <span
                class="request-detail__value"
              >
                Denver
                , 
                CO
              </span>
            </div>
          </div>
        </div>
        <div
          class="request-detail__section"
        >
          <div
            class="request-detail__section-title"
          >
            People
          </div>
          <div
            class="request-detail__grid"
          >
            <div
              class="request-detail__field"
            >
              <span
                class="request-detail__label"
              >
                Requested by
              </span>
              <span
                class="request-detail__value"
              >
                user-abcΓÇª
                <button
                  aria-label="Start chat with user-abcΓÇª"
                  class="chat-btn-inline"
                  data-testid="chat-button"
                  title="Chat with user-abcΓÇª"
                  type="button"
                >
                  ≡ƒÆ¼
                </button>
              </span>
            </div>
            <div
              class="request-detail__field"
            >
              <span
                class="request-detail__label"
              >
                Assigned to
              </span>
              <span
                class="request-detail__value"
              >
                Bob Producer
              </span>
            </div>
          </div>
        </div>
        <div
          class="request-detail__section"
        >
          <div
            class="request-detail__section-title"
          >
            Shipping
          </div>
          <div
            class="request-detail__grid"
          />
        </div>
        <div
          class="request-detail__stage-section"
        >
          <div
            class="request-detail__early-timeline"
          >
            <div
              class="request-detail__early-step"
            >
              <span
                class="request-detail__early-check"
              >
                Γ£ô
              </span>
              <span
                class="request-detail__early-label"
              >
                Requested
              </span>
              <span
                class="request-detail__early-date"
              >
                Feb 17, 2026
              </span>
            </div>
          </div>
          <div
            aria-label="Fulfillment stage"
            class="request-detail__stage-bar"
            data-testid="stage-bar"
            role="group"
          >
            <button
              aria-current="step"
              class="stage-btn stage-btn--active stage-btn--approved"
              data-testid="stage-btn-approved"
              disabled=""
              title="Current stage: Approved"
            >
              <span
                class="stage-btn__icon"
              >
                Γ£ô
              </span>
              <span
                class="stage-btn__label"
              >
                Approved
              </span>
            </button>
            <button
              class="stage-btn stage-btn--future stage-btn--in_progress"
              data-testid="stage-btn-in_progress"
              title="Move to In Progress"
            >
              <span
                class="stage-btn__icon"
              >
                ≡ƒö¿
              </span>
              <span
                class="stage-btn__label"
              >
                In Progress
              </span>
            </button>
            <button
              class="stage-btn stage-btn--future stage-btn--shipped"
              data-testid="stage-btn-shipped"
              title="Move to Shipped"
            >
              <span
                class="stage-btn__icon"
              >
                ≡ƒôª
              </span>
              <span
                class="stage-btn__label"
              >
                Shipped
              </span>
            </button>
          </div>
        </div>
        <div
          class="request-detail__actions"
        >
          <div
            class="request-detail__ship-form"
          >
            <p
              class="request-detail__no-reveal"
            >
              ΓÅ│ Address reveal pending ΓÇö the reveal hasn't synced yet.
            </p>
            <label>
              Tracking # (optional)
              <input
                placeholder="1Z999AA10123456784"
                type="text"
                value=""
              />
            </label>
            <button
              class="btn-primary"
            >
              ≡ƒôª Mark as Shipped
            </button>
          </div>
        </div>
      </div>
    </div>
System.Management.Automation.RemoteException
      1401 |
      1402 |     // RequestDetail should show with Mark In Progress button (inside the slide panel)
    > 1403 |     await waitFor(() => {
           |                  ^
      1404 |       const panel = document.querySelector('.slide-panel__body');
      1405 |       expect(within(panel).getByText('≡ƒö¿ Mark In Progress')).toBeInTheDocument();
      1406 |     });
System.Management.Automation.RemoteException
      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/producer-shipping-workflow.test.jsx:1403:18)
System.Management.Automation.RemoteException
Test Suites: 1 failed, 1 total
Tests:       4 failed, 47 passed, 51 total
Snapshots:   0 total
Time:        5.89 s
Ran all test suites matching /tests\\producer-shipping-workflow.test.jsx/i.
